<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Калькулятор електричних навантажень</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    table, th, td { border: 1px solid black; border-collapse: collapse; padding: 5px; }
    table { margin-bottom: 20px; }
    input[type="number"] { width: 80px; }
  </style>
</head>
<body>
  <h1>Калькулятор електричних навантажень (метод УД)</h1>

  <table id="epTable">
    <thead>
      <tr>
        <th>Назва ЕП</th>
        <th>n</th>
        <th>Pн (кВт)</th>
        <th>ηн</th>
        <th>cos φ</th>
        <th>Uн (кВ)</th>
        <th>Kв</th>
        <th>tg φ</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Шліфувальний верстат</td>
        <td><input type="number" value="4"></td>
        <td><input type="number" value="20"></td>
        <td><input type="number" step="0.01" value="0.92"></td>
        <td><input type="number" step="0.01" value="0.9"></td>
        <td><input type="number" step="0.01" value="0.38"></td>
        <td><input type="number" step="0.01" value="0.15"></td>
        <td><input type="number" step="0.01" value="1.33"></td>
      </tr>
      <tr>
        <td>Циркулярна пила</td>
        <td><input type="number" value="1"></td>
        <td><input type="number" value="36"></td>
        <td><input type="number" step="0.01" value="0.92"></td>
        <td><input type="number" step="0.01" value="0.9"></td>
        <td><input type="number" step="0.01" value="0.38"></td>
        <td><input type="number" step="0.01" value="0.3"></td>
        <td><input type="number" step="0.01" value="1.52"></td>
      </tr>
      <!-- Add other rows as needed -->
    </tbody>
  </table>

  <button onclick="calculate()">Розрахувати</button>

  <div id="result" class="result"></div>

  <script>
    const kpTable = {
      "0.2": {"15": 1.25, "14": 1.26, "13": 1.27},
      "0.32": {"56": 0.7, "55": 0.71}
      // Додайте інші значення за таблицею 6.3 та 6.4 за потреби
    };

    function findKp(kv, ne) {
      const kvStr = Object.keys(kpTable).reduce((prev, curr) => Math.abs(curr - kv) < Math.abs(prev - kv) ? curr : prev);
      const neStr = Object.keys(kpTable[kvStr]).reduce((prev, curr) => Math.abs(curr - ne) < Math.abs(prev - ne) ? curr : prev);
      return kpTable[kvStr][neStr];
    }

    function calculate() {
      const rows = document.querySelectorAll("#epTable tbody tr");
      let P_sum = 0, Pkv_sum = 0, P2_sum = 0, Pkv_tg_sum = 0;

      rows.forEach(row => {
        const n = parseFloat(row.cells[1].querySelector("input").value);
        const Pn = parseFloat(row.cells[2].querySelector("input").value);
        const kv = parseFloat(row.cells[6].querySelector("input").value);
        const tgPhi = parseFloat(row.cells[7].querySelector("input").value);

        const P = n * Pn;
        P_sum += P;
        Pkv_sum += P * kv;
        Pkv_tg_sum += P * kv * tgPhi;
        P2_sum += n * Pn * Pn;
      });

      const kvGroup = Pkv_sum / P_sum;
      const ne = Math.round(P_sum * P_sum / P2_sum);
      const kp = findKp(kvGroup.toFixed(2), ne);
      const Pp = kp * Pkv_sum;
      const Qp = kp * Pkv_tg_sum;
      const Sp = Math.sqrt(Pp**2 + Qp**2);
      const Un = parseFloat(rows[0].cells[5].querySelector("input").value);
      const Ip = Sp * 1000 / (Math.sqrt(3) * Un * 1000);

      document.getElementById("result").innerHTML = `
        <strong>Результати розрахунку:</strong><br>
        Груповий коефіцієнт використання (Kв): ${kvGroup.toFixed(4)}<br>
        Ефективна кількість ЕП (ne): ${ne}<br>
        Розрахунковий коефіцієнт активної потужності (Kр): ${kp}<br>
        Розрахункове активне навантаження (Pp): ${Pp.toFixed(2)} кВт<br>
        Розрахункове реактивне навантаження (Qp): ${Qp.toFixed(2)} квар<br>
        Повна потужність (Sp): ${Sp.toFixed(2)} кВА<br>
        Розрахунковий струм (Ip): ${Ip.toFixed(2)} A
      `;
    }
  </script>
</body>
</html>
